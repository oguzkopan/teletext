# News Pages (2xx) - Live Data Implementation

## Overview

All news pages (200-209) now fetch **live data** from the News API, providing real-time news headlines and articles.

## Pages Implemented

### Main News Pages

- **Page 200** - News Headlines & Breaking News
  - Top headlines from multiple sources
  - Breaking news indicator
  - Links to all news categories
  - Live updates every 5 minutes

- **Page 201** - UK News & Local Updates
  - UK-specific news headlines
  - Falls back to general news if UK news unavailable
  - 5 latest articles with navigation

- **Page 202** - World News & International
  - International news from around the globe
  - General category news
  - 5 latest articles with navigation

- **Page 203** - Local News & Community
  - US local news (configurable)
  - Community updates
  - 5 latest articles with navigation

### Category Pages

- **Page 204** - Business & Economy
  - Business news and financial updates
  - Market-related stories

- **Page 205** - Technology & Innovation
  - Tech industry news
  - Innovation and startup stories

- **Page 206** - Science & Health
  - Scientific discoveries
  - Health and medical news

- **Page 207** - Entertainment & Culture
  - Entertainment industry news
  - Cultural events and stories

- **Page 208** - Politics & Government
  - Political news and government updates
  - Policy changes and debates

- **Page 209** - Environment & Climate
  - Environmental news
  - Climate change updates

### Article Detail Pages

All main pages support sub-pages for article details:
- `200-1`, `200-2`, `200-3`, etc. - Individual articles from page 200
- `201-1`, `201-2`, `201-3`, etc. - Individual articles from page 201
- And so on for all news pages

## Features

### Live Data
- All pages fetch real-time data from News API
- Automatic caching for 5 minutes to optimize performance
- Fallback to general news if specific categories unavailable

### Rich Formatting
- Teletext-style colored text and borders
- Breaking news indicators (ðŸ”´)
- Time-ago formatting (e.g., "5 minutes ago", "2 hours ago")
- Source attribution for each article

### Navigation
- Single-digit navigation (press 1-5 to read articles)
- Colored button navigation (RED, GREEN, YELLOW, BLUE)
- Breadcrumb navigation in article pages
- Previous/Next article navigation

### Error Handling
- Graceful fallback when API is unavailable
- User-friendly error messages
- Automatic retry with alternative endpoints

## API Configuration

The News API key is configured in `.env.local`:

```bash
NEWS_API_KEY=44c30f5450634eaeaa9eea6e0cbde0d0
```

### API Endpoints Used

1. **Top Headlines by Country**
   ```
   GET /v2/top-headlines?country=gb&pageSize=5
   ```

2. **Top Headlines by Category**
   ```
   GET /v2/top-headlines?category={category}&pageSize=5
   ```

3. **Categories**: general, business, technology, science, entertainment

## Technical Implementation

### NewsAdapter Class

Located in `lib/adapters/NewsAdapter.ts`, this class handles all news data fetching:

- `getPage(pageId)` - Main entry point for fetching any news page
- `getNewsIndexPage()` - Fetches page 200
- `getUKNewsPage()` - Fetches page 201
- `getWorldNewsPage()` - Fetches page 202
- `getLocalNewsPage()` - Fetches page 203
- `getCategoryNewsPage(pageId)` - Fetches pages 204-209
- `getNewsArticleDetailPage(pageId)` - Fetches article detail pages

### Helper Methods

- `formatArticlesForIndex()` - Formats articles for the main index page
- `formatArticlesForList()` - Formats articles for category pages
- `getTimeAgo()` - Converts timestamps to human-readable format
- `wrapText()` - Wraps long text for teletext display
- `truncateText()` - Truncates text to fit display width

### Page Registry Integration

The page registry (`lib/page-registry.ts`) has been updated to remove static news pages. All news pages are now dynamically generated by the NewsAdapter.

### API Route

The API route (`app/api/page/[pageNumber]/route.ts`) routes all 2xx pages to the NewsAdapter:

```typescript
case 2: // News (200-299)
  const newsAdapter = new NewsAdapter();
  page = await newsAdapter.getPage(pageNumber);
  break;
```

## Testing

### Manual Testing

1. Start the development server:
   ```bash
   npm run dev
   ```

2. Navigate to news pages:
   - Go to page 100 (index)
   - Press GREEN button or type 200 to go to news
   - Navigate through different news categories
   - Press 1-5 to read individual articles

### API Testing

Run the test script to verify News API connectivity:

```bash
node scripts/test-news-api.js
```

This will test:
- UK headlines (page 200, 201)
- World news (page 202)
- Local news (page 203)
- Technology news (page 205)
- Business news (page 204)

## Caching Strategy

- **Server-side caching**: 5 minutes (300 seconds)
- **Next.js revalidation**: Automatic with `next: { revalidate: 300 }`
- **Client-side**: No caching (always fresh data)

## Future Enhancements

1. **Search functionality** - Allow users to search for specific news topics
2. **Personalization** - Save favorite news categories
3. **More sources** - Integrate additional news APIs
4. **Localization** - Support for multiple languages and regions
5. **Bookmarks** - Save articles for later reading
6. **Notifications** - Alert users to breaking news

## Troubleshooting

### No Articles Displayed

If you see "No articles available":
1. Check your News API key in `.env.local`
2. Verify API key is valid at https://newsapi.org/
3. Check API rate limits (free tier: 100 requests/day)
4. Review console logs for error messages

### API Rate Limit Exceeded

The free tier of News API has limits:
- 100 requests per day
- 1 request per second

If you exceed these limits:
1. Wait 24 hours for reset
2. Upgrade to a paid plan
3. Implement more aggressive caching

### Stale Data

If data appears outdated:
1. Clear Next.js cache: `rm -rf .next`
2. Rebuild: `npm run build`
3. Check cache headers in API responses

## API Documentation

For more information about the News API:
- Documentation: https://newsapi.org/docs
- Get API key: https://newsapi.org/register
- Pricing: https://newsapi.org/pricing

## Summary

The 2xx news pages are now fully functional with live data from the News API. Users can browse breaking news, category-specific news, and read full articles with proper navigation and formatting. The implementation includes robust error handling, caching, and fallback mechanisms to ensure a smooth user experience.
